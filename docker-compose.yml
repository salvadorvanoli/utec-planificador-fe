services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile
      target: ${BUILD_TARGET:-production}
    platform: linux/amd64
    
    container_name: ${COMPOSE_PROJECT_NAME:-planificador}-frontend
    restart: unless-stopped
    
    labels:
      - "com.utec.project=planificador-docente"
      - "com.utec.component=frontend"
      - "com.utec.environment=development"
      - "com.utec.framework=angular"
      - "com.utec.version=1.0.0"
    
    ports:
      - "${FRONTEND_PORT:-4200}:80"
    
    environment:
      - NODE_ENV=${NODE_ENV:-production}
      - BACKEND_API_URL=${BACKEND_API_URL:-http://localhost:8080/api}
    
    networks:
      - frontend-network
      - utec-shared
    
    healthcheck:
      test: ["CMD", "curl", "--fail", "--silent", "http://localhost"]
      interval: ${HEALTHCHECK_INTERVAL:-30s}
      timeout: ${HEALTHCHECK_TIMEOUT:-3s}
      retries: ${HEALTHCHECK_RETRIES:-3}
      start_period: ${HEALTHCHECK_START_PERIOD:-5s}

networks:
  frontend-network:
    driver: bridge
    name: ${COMPOSE_PROJECT_NAME:-planificador}-frontend-network
  
  utec-shared:
    external: true
    name: utec-shared-network
