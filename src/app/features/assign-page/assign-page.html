<app-section-header
    [text]="pageTitle()"
    [color]="'blue'"
    [showIcon]="true"
    [infoType]="InfoType.ASSIGN_COURSES"
/>

<div class="row mt-4 mb-10 grid grid-cols-1 md:grid-cols-2 gap-10 w-4/5 mx-auto align-items-stretch">
  <!-- Teacher Selection (Multiple) -->
  <div>
    <label for="select_teachers" class="block text-sm font-medium mb-1">
      Docentes
    </label>
    @if (isLoadingTeachers()) {
      <p class="text-gray-500">Cargando docentes...</p>
    } @else {
      <app-multiselect
        id="select_teachers"
        [color]="'black'"
        [placeholder]="'Seleccione uno o mÃ¡s docentes'"
        [options]="teacherOptions()"
        [selectedValues]="selectedTeachers()"
        (onSelectionChange)="onTeachersChange($event)"
        [showClear]="true"
        [filter]="true"
        [filterPlaceholder]="'Buscar docente'"
        class="w-full"
      ></app-multiselect>
    }
  </div>

  <!-- Curricular Unit Selection -->
  <div>
    <label for="select_curricular_unit" class="block text-sm font-medium mb-1">
      Unidad Curricular
      @if (isEditMode()) {
        <span class="text-xs text-gray-500 ml-2">(no se puede modificar)</span>
      }
    </label>
    @if (isLoadingCurricularUnits()) {
      <p class="text-gray-500">Cargando unidades curriculares...</p>
    } @else {
      <app-select 
        id="select_curricular_unit"
        [color]="isEditMode() ? 'black' : 'blue'" 
        [placeholder]="'Seleccione una unidad curricular'"
        [options]="curricularUnitOptions()"
        [selectedValue]="selectedCurricularUnit()"
        (onSelectionChange)="onCurricularUnitChange($event)"
        [disabled]="isEditMode()"
        class="w-full"
        [class.opacity-60]="isEditMode()"
        [class.cursor-not-allowed]="isEditMode()"
      ></app-select>
    }
  </div>
</div>

<!-- Course Info Component -->
<app-course-info
  [courseData]="isEditMode() ? courseData() : null"
  [isLoading]="isLoadingCourse()"
  [isAdminMode]="true"
  [curricularUnitId]="selectedCurricularUnit() ? +selectedCurricularUnit() : null"
  [teacherIds]="selectedTeacherIds()"
  (onCourseCreated)="onCourseCreated($event)"
  (onCourseUpdated)="onCourseUpdated($event)"
></app-course-info>

<!-- Create/Update Button -->
<div class="mt-4 mb-10 w-4/5 mx-auto">
@if (isFormValid() || isEditMode()) {
  <app-button
    [label]="buttonLabel()"
    [color]="'blue'"
    fontFamily="'UTEC Text Light', Arial, sans-serif"
    fontWeight="300"
    fontSize="1.5rem"
    (onClick)="onCreateOrUpdateCourse()"
  ></app-button>
} @else {
  <app-button
    [label]="buttonLabel()"
    [color]="'black'"
    fontFamily="'UTEC Text Light', Arial, sans-serif"
    fontWeight="300"
    fontSize="1.5rem"
    [textColor]="'#9CA3AF'"
  ></app-button>
}
