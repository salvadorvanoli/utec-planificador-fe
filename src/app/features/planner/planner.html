<app-section-header
    [color]="'blue'"
    [showIcon]="true"
    [infoType]="InfoType.PLANNER"
/>

<app-course-info 
  [courseData]="courseData()" 
  [isLoading]="isLoadingCourse()"
  (onCourseUpdated)="handleCourseUpdate($event)"
></app-course-info>

<div class="flex items-center gap-2 mb-8">
  <app-titulo class="w-full sm:w-[460px] text-left" [color]="'blue'" [texto]="'PlanificaciÃ³n semanal'"></app-titulo>
  
  <button 
    class="mt-7 w-[46px] h-[46px] rounded-full flex items-center justify-center bg-[#00A9E0] hover:scale-110 transition-transform duration-300"
    aria-label="Historial de cambios"
    pTooltip="Historial de cambios"
    tooltipPosition="top"
    (click)="openHistoryModal()">
    <i class="pi pi-history text-white text-xl"></i>
  </button>
  
  <button 
    class="mt-7  w-[46px] h-[46px] rounded-full flex items-center justify-center bg-[#00A9E0] hover:scale-110 transition-transform duration-300"
    aria-label="Ampliar vista"
    pTooltip="Ampliar vista"
    tooltipPosition="top">
    <i class="pi pi-search-plus text-white text-xl"></i>
  </button>
  
  <button 
    class="mt-7  w-[46px] h-[46px] rounded-full flex items-center justify-center bg-[#00A9E0] hover:scale-110 transition-transform duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
    [class.animate-pulse]="isGeneratingPdf()"
    aria-label="Descargar PDF"
    [pTooltip]="isGeneratingPdf() ? 'Generando PDF...' : 'Descargar PDF'"
    tooltipPosition="top"
    [disabled]="isGeneratingPdf()"
    (click)="downloadPdf()">
    <i [class]="isGeneratingPdf() ? 'pi pi-spin pi-spinner text-white text-xl' : 'pi pi-download text-white text-xl'"></i>
  </button>
</div>
  
@if (courseData()) {
  <app-weekly-plan 
    [courseId]="courseData()!.id"
    [courseStartDate]="courseData()!.startDate"
    [courseEndDate]="courseData()!.endDate"
  ></app-weekly-plan>
}

<app-change-history 
  [visible]="showHistoryModal()"
  [courseId]="courseData()?.id ?? 0"
  (onClose)="closeHistoryModal()">
</app-change-history>

