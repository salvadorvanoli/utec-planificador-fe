<div class="option-panel-container">
  <div class="option-panel-wrapper">
    @if (step() === 'itr') {
      <div class="selection-grid">
        <h2 class="selection-title">Selecciona tu Instituto Tecnológico Regional</h2>

        @if (isLoading()) {
          @for (item of [1, 2, 3]; track item) {
            <div class="selection-card skeleton-card">
              <p-skeleton shape="circle" size="4rem"></p-skeleton>
              <p-skeleton width="70%" height="1.5rem"></p-skeleton>
            </div>
          }
        } @else {
          @if (positionService.availableITRs().length === 0) {
            <div class="empty-state">
              <div class="empty-icon">
                <i class="pi pi-inbox"></i>
              </div>
              <h3 class="empty-title">No tienes posiciones asignadas</h3>
              <p class="empty-description">
                Actualmente no estás asignado a ningún Instituto Tecnológico Regional.
                Por favor, contacta al administrador del sistema para que te asigne una posición.
              </p>
              <button class="back-button" (click)="goToHome()">
                <i class="pi pi-home"></i>
                Volver al inicio
              </button>
            </div>
          } @else {
            @for (itr of positionService.availableITRs(); track itr.id) {
              <div class="selection-card" (click)="handleITRSelection(itr)">
                <div class="card-icon">
                  <i class="pi pi-building"></i>
                </div>
                <h3 class="card-title">{{ itr.name }}</h3>
              </div>
            }
          }
        }
      </div>
    }

    @if (step() === 'campus') {
      <div class="selection-grid">
        <button class="back-navigation" (click)="goBackToITR()">
          <i class="pi pi-arrow-left"></i>
          Volver a selección de ITR
        </button>

        <h2 class="selection-title">Selecciona tu Sede</h2>

        @if (isLoading()) {
          @for (item of [1, 2]; track item) {
            <div class="selection-card skeleton-card">
              <p-skeleton shape="circle" size="4rem"></p-skeleton>
              <p-skeleton width="70%" height="1.5rem"></p-skeleton>
            </div>
          }
        } @else {
          @for (campus of positionService.availableCampuses(); track campus.id) {
            <div class="selection-card" (click)="handleCampusSelection(campus)">
              <div class="card-icon">
                <i class="pi pi-map-marker"></i>
              </div>
              <h3 class="card-title">{{ campus.name }}</h3>
            </div>
          }
        }
      </div>
    }

    @if (step() === 'main-menu') {
      <div class="main-menu-container">
        <button class="back-navigation" (click)="goBackToCampus()">
          <i class="pi pi-arrow-left"></i>
          Volver a selección de Campus
        </button>

        <div class="context-info">
          <div class="context-item">
            <i class="pi pi-building"></i>
            <span>{{ positionService.selectedContext()?.itr?.name }}</span>
          </div>
          <div class="context-separator">→</div>
          <div class="context-item">
            <i class="pi pi-map-marker"></i>
            <span>{{ positionService.selectedContext()?.campus?.name }}</span>
          </div>
        </div>

        <div class="menu-grid">
          @if (isLoading()) {
            @for (item of [1, 2, 3]; track item) {
              <div class="menu-card skeleton-card">
                <p-skeleton shape="circle" size="4rem"></p-skeleton>
                <p-skeleton width="60%" height="1.5rem" styleClass="mb-2"></p-skeleton>
                <p-skeleton width="100%" height="1rem"></p-skeleton>
              </div>
            }
          } @else {
            @for (card of availableMenuCards(); track card.id) {
              <app-option-card
                [icon]="card.icon"
                [title]="card.title"
                [description]="card.description"
                (click)="handleButtonClick(card.action)"
              ></app-option-card>
            }
          }
        </div>
      </div>
    }
  </div>
</div>
